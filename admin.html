<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Admin - Marnissi Barbershop</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin-styles.css">
</head>

<body>
    <!-- Login Page -->
    <div id="login-page" class="page active">
        <div class="container">
            <div class="card" style="max-width: 400px; margin: 4rem auto; text-align: center;">
                <h1 style="font-size: 2rem;">ğŸ” Panel de AdministraciÃ³n</h1>
                <p style="color: var(--text-secondary); margin: 1rem 0;">Marnissi Barbershop</p>

                <form id="login-form" style="margin-top: 2rem;">
                    <div class="input-group">
                        <label>ContraseÃ±a</label>
                        <input type="password" id="admin-password" required placeholder="Introduce la contraseÃ±a">
                    </div>
                    <p id="login-error" style="color: var(--error); display: none; margin-bottom: 1rem;">ContraseÃ±a
                        incorrecta</p>
                    <button type="submit" class="btn-primary">Acceder</button>
                </form>

                <a href="index.html" class="btn-secondary"
                    style="display: inline-block; margin-top: 1rem; text-decoration: none; width: 100%; max-width: 300px;">
                    â† Volver a Reservas
                </a>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-page" class="page">
        <div class="admin-header">
            <div class="container">
                <div class="header-content">
                    <h1>Panel de AdministraciÃ³n</h1>
                    <div class="header-buttons">
                        <a href="index.html" class="btn-secondary btn-small"
                            style="text-decoration: none; margin-right: 0.5rem;">
                            â† Volver a Reservas
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- Search -->
            <div class="card" style="margin-top: 2rem; margin-bottom: 1rem;">
                <div class="input-group" style="margin-bottom: 0; display: flex; gap: 0.5rem;">
                    <input type="text" id="admin-search" placeholder="Buscar por nombre o telÃ©fono..."
                        onkeyup="handleSearch(this.value)" style="margin-bottom: 0;">
                    <button class="btn-primary" onclick="triggerSearch()"
                        style="width: auto; padding: 0 1.5rem;">ğŸ”</button>
                </div>
            </div>

            <!-- Date Selector -->
            <div class="card" style="margin-top: 1rem;">
                <div class="date-selector">
                    <button class="btn-secondary" onclick="changeDate(-1)">â† DÃ­a Anterior</button>
                    <div class="current-date">
                        <input type="date" id="admin-date" onchange="loadAppointments()">
                        <h2 id="date-display"></h2>
                    </div>
                    <button class="btn-secondary" onclick="changeDate(1)">DÃ­a Siguiente â†’</button>
                </div>
            </div>

            <!-- Availability Management -->
            <div class="card" style="margin-top: 1rem; text-align: center;">
                <h3>Disponibilidad del DÃ­a</h3>
                <div class="availability-controls" style="margin-top: 1rem;">
                    <select id="availability-select" onchange="setAvailability(this.value)"
                        style="max-width: 300px; margin: 0 auto; text-align: center;">
                        <option value="2">ğŸŸ¢ Normal (2 Barberos)</option>
                        <option value="1">ğŸŸ¡ Solo 1 Barbero</option>
                        <option value="0">ğŸ”´ Cerrado</option>
                    </select>
                </div>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“…</div>
                    <div class="stat-info">
                        <h3 id="total-appointments">0</h3>
                        <p>Citas Totales</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">â°</div>
                    <div class="stat-info">
                        <h3 id="next-appointment">--:--</h3>
                        <p>PrÃ³xima Cita</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">âœ‚ï¸</div>
                    <div class="stat-info">
                        <h3 id="available-slots">0</h3>
                        <p>Huecos Disponibles</p>
                    </div>
                </div>
            </div>

            <!-- Calendar View -->
            <div class="card">
                <div class="calendar-header">
                    <h2>Calendario de Citas</h2>
                    <button class="btn-primary btn-small" onclick="loadAppointments()">ğŸ”„ Actualizar</button>
                </div>

                <div id="loading-appointments" class="loader" style="display: none;"></div>

                <div id="appointments-calendar"></div>

                <div id="no-appointments"
                    style="display: none; text-align: center; padding: 3rem; color: var(--text-secondary);">
                    <p style="font-size: 1.2rem;">ğŸ“­</p>
                    <p>No hay citas para este dÃ­a</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <!-- App Scripts -->
    <script src="config.js?v=3"></script>
    <script src="admin_panel.js"></script>
</body>

</html>